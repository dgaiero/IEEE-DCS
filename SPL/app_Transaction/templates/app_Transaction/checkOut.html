<!--Import template base.html layout-->
{% extends 'base.html' %}

<!DOCTYPE html>
<html>

<head>
  {% block head %}
  <title>CheckOut Page</title>
  {% endblock %}
  <!--Needed for importing static files
    {% load static %}
     <link rel="stylesheet" href="{% static 'app_Transaction/style.css' %}" type="text/css">
    -->
</head>

<body>
  {% block body %}
  <br>
  <div class="container">
    <h1>CheckOut Page</h1>
    <form class="partSelect">
      {% csrf_token %}
      <p>
        Part: {{ checkOutForm.part }} Quantity: {{ checkOutForm.quantity }}
      </p>
      <!--<button type="submit" class="btn btn-outline-secondary" role="button">Submit</a>-->
    </form>
    <!--Table test
      <table class="table table-bordered">
  <thead>
    <tr>
      <th scope="col">Part</th>
      <th scope="col">Quantity</th>
      <th scope="col">Quantity Checked Out</th>
      <th scope="col">Id Number</th>
    </tr>
  </thead>
  <tbody>
    {% for part in registered_Parts_List %}
    <tr>
      <td>{{ part }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
-->
    <button id="addItemButton" class="btn btn-outline-secondary btn-lg btn-block" onclick="addPartToOrder()" type="submit">Add item</button>
    <button id="submitButton" class="btn btn-outline-secondary btn-lg btn-block" onclick="sendPostData()" type="submit">Submit Query</button>
    <!-- <input type="submit" class="btn btn-outline-secondary btn-lg btn-block" value="Submit Data"></submit> -->

    <!-- <a href="#" class="btn btn-outline-secondary btn-lg btn-block" role="button">Add Item</a> -->
    <br>
    <h3>
        Check Out Queue
      </h3>
    <div class="result">
      <ul class="list">
      </ul>
    </div>
    <pre id ="results__display"></pre>
    <br>
    <a href="{% url 'another_Action' %}" class="btn btn-outline-secondary btn-lg btn-block" role="button">Finish Checking Out</a>
    <br>
  </div>

  <script type="text/javascript">
    "use strict";
    var outerObj = [];

    function addPartToOrder(event) {
      // Stop the form from submitting since weâ€™re handling that with AJAX.
      event.preventDefault();


      var inputs = $(".partSelect :input");
      var obj = $.map(inputs, function(x, y) {
        if (x.type !== "submit") {
          return {
            Key: x.name,
            Value: $(x).val()
          };
        };
      });
      outerObj.push(obj);

      $('#result').append($('ul.list').append('<li>' + obj[1]["Value"] + ' , ' + obj[2]["Value"] + '</li>'));
      console.log(obj);
      <!-- $('#result').append(obj[1]["Value"]); -->

    };

    function sendPostData(event) {
      event.preventDefault();
      document.getElementById("results__display").innerHTML = JSON.stringify(outerObj);
      var partData = JSON.stringify(outerObj);
      console.log(partData);
      $.post("",
        {
          csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,
          // outerObj
          partData
        });
    };

    var addPartButton = document.getElementById("addItemButton").addEventListener("click", addPartToOrder);
    var sendPostDataEvent = document.getElementById("submitButton").addEventListener("click", sendPostData);
    document.addEventListener("submit", sendPostData);
  </script>
  {% endblock %}
</body>





</html>
